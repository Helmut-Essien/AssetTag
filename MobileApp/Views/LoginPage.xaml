<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="MobileApp.Views.LoginPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:buttons="clr-namespace:Syncfusion.Maui.Toolkit.Buttons;assembly=Syncfusion.Maui.Toolkit"
    xmlns:inputLayout="clr-namespace:Syncfusion.Maui.Toolkit.TextInputLayout;assembly=Syncfusion.Maui.Toolkit"
    xmlns:viewmodels="clr-namespace:MobileApp.ViewModels"
    x:DataType="viewmodels:LoginViewModel"
    Shell.NavBarIsVisible="False">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!--  Gradient Background  -->
            <LinearGradientBrush x:Key="LoginGradient" StartPoint="0,0" EndPoint="1,1">
                <GradientStop Offset="0.0" Color="#512BD4" />
                <GradientStop Offset="1.0" Color="#2B0B98" />
            </LinearGradientBrush>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid Background="{StaticResource LoginGradient}">

        <!--  Decorative Background Circles  -->
        <AbsoluteLayout>
            <!--  Top Left Circle  -->
            <BoxView
                AbsoluteLayout.LayoutBounds="0, 0, 200, 200"
                AbsoluteLayout.LayoutFlags="None"
                BackgroundColor="#FFFFFF"
                CornerRadius="100"
                HeightRequest="200"
                Opacity="0.1"
                TranslationX="-100"
                TranslationY="-100"
                WidthRequest="200" />

            <!--  Top Right Circle  -->
            <BoxView
                AbsoluteLayout.LayoutBounds="1, 0, 150, 150"
                AbsoluteLayout.LayoutFlags="PositionProportional"
                BackgroundColor="#FFFFFF"
                CornerRadius="75"
                HeightRequest="150"
                Opacity="0.08"
                TranslationX="50"
                TranslationY="-50"
                WidthRequest="150" />

            <!--  Bottom Right Circle  -->
            <BoxView
                AbsoluteLayout.LayoutBounds="1, 1, 180, 180"
                AbsoluteLayout.LayoutFlags="PositionProportional"
                BackgroundColor="#FFFFFF"
                CornerRadius="90"
                HeightRequest="180"
                Opacity="0.12"
                TranslationX="80"
                TranslationY="80"
                WidthRequest="180" />

            <!--  Bottom Left Circle  -->
            <BoxView
                AbsoluteLayout.LayoutBounds="0, 1, 120, 120"
                AbsoluteLayout.LayoutFlags="PositionProportional"
                BackgroundColor="#FFFFFF"
                CornerRadius="60"
                HeightRequest="120"
                Opacity="0.09"
                TranslationX="-40"
                TranslationY="40"
                WidthRequest="120" />
        </AbsoluteLayout>

        <!--  Main Content - Removed ScrollView for single screen fit  -->
        <VerticalStackLayout
            Padding="30,20,30,20"
            Spacing="15"
            VerticalOptions="Center">

            <!--  Logo Container - Smaller  -->
            <Border
                Padding="15"
                BackgroundColor="White"
                HeightRequest="120"
                HorizontalOptions="Center"
                StrokeThickness="0"
                WidthRequest="120">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="20" />
                </Border.StrokeShape>
                <Image
                    Aspect="AspectFit"
                    HorizontalOptions="Center"
                    Source="methodist_university_logo.png"
                    VerticalOptions="Center" />
            </Border>

            <!--  Welcome Text - Compact  -->
            <VerticalStackLayout Spacing="4">
                <Label
                    FontAttributes="Bold"
                    FontSize="24"
                    HorizontalTextAlignment="Center"
                    Text="Welcome Back"
                    TextColor="White" />
                <Label
                    FontSize="14"
                    HorizontalTextAlignment="Center"
                    Opacity="0.9"
                    Text="Sign in to your account"
                    TextColor="White" />
            </VerticalStackLayout>

            <!--  Login Form Card - Compact  -->
            <Border
                Margin="0,20,0,5"
                Padding="25,25,25,10"
                BackgroundColor="White"
                StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="20" />
                </Border.StrokeShape>

                <VerticalStackLayout Spacing="0.2">

                    <!--  Email Field - Compact  -->
                    <inputLayout:SfTextInputLayout
                        ContainerType="Outlined"
                        Hint="Email Address"
                        OutlineCornerRadius="20">
                        <Entry
                            FontSize="12"
                            Keyboard="Email"
                            Text="{Binding Email}"
                            TextColor="{StaticResource Gray900}" />
                    </inputLayout:SfTextInputLayout>

                    <!--  Password Field - Compact  -->
                    <inputLayout:SfTextInputLayout
                        ContainerType="Outlined"
                        EnablePasswordVisibilityToggle="True"
                        Hint="Password"
                        OutlineCornerRadius="20">
                        <Entry
                            FontSize="12"
                            IsPassword="True"
                            Text="{Binding Password}"
                            TextColor="{StaticResource Gray900}" />
                    </inputLayout:SfTextInputLayout>

                    <!--  Error Message - Compact  -->
                    <Border
                        Padding="10,8"
                        BackgroundColor="#FFEBEE"
                        IsVisible="{Binding HasError}"
                        Stroke="#EF5350"
                        StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>
                        <Label
                            FontSize="12"
                            LineBreakMode="WordWrap"
                            Text="{Binding ErrorMessage}"
                            TextColor="#C62828" />
                    </Border>

                    <!--  Login Button - Compact  -->
                    <buttons:SfButton
                        Margin="0,5,0,0"
                        Command="{Binding LoginCommand}"
                        CornerRadius="20"
                        FontAttributes="Bold"
                        FontSize="16"
                        HeightRequest="48"
                        Text="Sign In">
                        <buttons:SfButton.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Offset="0.0" Color="#512BD4" />
                                <GradientStop Offset="1.0" Color="#2B0B98" />
                            </LinearGradientBrush>
                        </buttons:SfButton.Background>
                    </buttons:SfButton>

                    <!--  Loading Indicator - Compact  -->
                    <ActivityIndicator
                        HeightRequest="30"
                        IsRunning="{Binding IsBusy}"
                        IsVisible="{Binding IsBusy}"
                        Color="{StaticResource Primary}" />

                    <!--  Biometric Login Button - Compact  -->
                    <buttons:SfButton
                        Margin="0,5,0,0"
                        BackgroundColor="Transparent"
                        Command="{Binding BiometricLoginCommand}"
                        CornerRadius="20"
                        FontSize="14"
                        HeightRequest="44"
                        IsVisible="{Binding BiometricEnabled}"
                        Stroke="{StaticResource Primary}"
                        StrokeThickness="2"
                        Text="ðŸ” Login with Biometrics"
                        TextColor="{StaticResource Secondary}" />

                    <!--  Forgot Password - Compact  -->
                    <Button
                        Margin="0,0,0,0"
                        Padding="0"
                        BackgroundColor="Transparent"
                        Command="{Binding ForgotPasswordCommand}"
                        FontAttributes="Bold"
                        FontSize="13"
                        Text="Forgot Password?"
                        TextColor="{StaticResource Primary}" />

                </VerticalStackLayout>
            </Border>

            <!--  App Version - Compact  -->
            <Label
                Margin="0,5,0,0"
                FontSize="11"
                HorizontalTextAlignment="Center"
                Opacity="0.7"
                Text="AssetTag Mobile v1.0"
                TextColor="White" />

        </VerticalStackLayout>
    </Grid>

</ContentPage>